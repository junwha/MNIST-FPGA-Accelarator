#include "mnist.h"


int main() {
	AXI_VAL IN[1600], OUT[640];

	D_TYPE IN_ARR[1600] = {-1, -1, -1, -1, -1, -30721, -520193, -6520833, -1835009, -12582913, -201326593, 1073741795, -511, -262017, -4177921, -7340033, -117440513, 536870883, -449, -14337, -458753, -6291457, -67108865, -1, -65536, -1, -1, -1, -1, -1, -1, -897, -16775169, -536838146, 96993255, -50331905, -1879048207, -225, -7169, -229377, -3145729, -117440513, 536870899, -449, -6145, -110593, -4063233, -62914561, -805306369, -65536, -1, -1, -1, -12582913, -1006632976, 536870401, -7281, -509697, -66596865, -2114125840, 1070595591, -50347009, -1879277576, -7340529, -100679169, -1612701704, 805568384, 16775168, 536838175, -258049, -1, -1, -1, -1, -65536, -1, -1, -1, -65011720, 33554176, 536866943, -122881, -1835009, -25165825, -402653186, 536870880, 1073741568, -121, -449, -3073, -49160, -1835520, 8384512, 134215680, -1793, -1, -1, -1, -1, -65536, -1, -1, -1, -7, -241, -8177, -262081, -8387585, -251781122, 535953347, -6292353, -50343937, -805765124, -7340081, -117441281, -805318660, 2147287011, -6291681, -503318528, 1073725455, -14337, -1, -1, -1, -65536, -1, -1, -1, -12582913, -67108868, 1073741571, -8129, -498689, -15843329, -504102916, 2134900623, -469765890, 2147426247, -1835905, -58748929, -807272456, -130023521, 134215681, -32641, -253953, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -7681, -243713, -6340609, -202113025, 2118123511, -469762177, 2147480567, -29057, -260097, -98305, -1572865, -25165825, -402653186, 2147483623, -385, -6145, -98305, -1048577, -1, -65536, -1, -1, -1, -1, -1, -1921, -65473, -1048065, -67100673, -2131689488, 521141761, -251666177, 268181489, -3932641, -125836801, -2013773832, -33030385, -2130710400, 1073709071, -523265, -8323073, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -4, -113, -1537, -6340609, -68943873, 1048575975, -805307143, -28737, -4180993, -126320641, -3145729, -50331649, -1610612741, -129, -6145, -196609, -2097153, -67108865, -1, -65536, -1, -1, -1, -1, -1610612743, -97, -1537, -57345, -917505, -12582913, -201326594, 1073741799, -897, -12289, -393217, -14680065, -234881026, 1073741767, -897, -28673, -393217, -1, -1, -1, -65536, -1, -1, -1, -7, -193, -6177, -198529, -3153409, -100720641, 536412147, -3146177, -50337793, -805404680, -3670113, -50334721, -1879293960, -15728753, -503317264, 2147467279, -129025, -917505, -1, -1, -1, -65536, -1, -1, -1, -4, 536870785, -4081, -130817, -3993601, -130940929, -2013265936, -241, -3841, -62433, -1048321, -16775169, -268402689, 63176688, 2084568835, -2013267968, -8161, -14337, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -57793, -2096129, -67100673, -1073610756, 239075327, -1006632968, 2147483407, -7681, -245761, -7864321, -125829122, 536870849, -961, -30721, -983041, -31457281, -469762049, 1073741823, -65536, -1, -1, -1, -1, -1, -12289, -1032193, -32243713, -1010827268, 2147483527, -1006634760, 1073712897, -507513, -4179841, -32521217, -253953, -1966081, -15728641, -125829121, -939524098, 2147483647, -1, -1, -1, -65536, -1, -1, -1, -1, -9, -193, -3073, -25214977, -470548482, 1061158883, -201326785, 1073738737, -49649, -409089, -8380417, -132513793, -274726913, -100663297, -1610612743, -113, -897, -12289, -1, -1, -65536, -1, -1, -1, -1, -1610612743, -225, -3585, -114689, -1835009, -29360129, -939524100, 2147483591, -1921, -28673, -393217, -14680065, -234881026, 536870883, -449, -7169, -98305, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -17, -65793, -2109441, -100794369, -1617166351, -125829217, 536869251, -32129, -6145, -98305, -1048577, -50331649, -536870919, -193, -3073, -32769, -1572865, -25165825, -1, -65536, -1, -1, -1, -1, -1, -113, -32513, -4157441, -117637121, 529530855, -100664193, -1610627079, -65729, -3841, -258049, -66846721, -58720257, -402653188, 2147483599, -769, -12289, -196609, -3145729, -1, -65536, -1, -1, -1, -1, -61, -8161, -523777, -8380417, -133955585, -2139095044, 67108800, 536869888, -241, -897, -14337, -229377, -7864321, -260046882, 268433408, -32737, -523265, -917505, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -8065, -261121, -67092481, 31719360, 2122316815, -805320712, -131297, -7169, -114689, -3670017, -117440513, -1879048207, -193, -7169, -98305, -3145729, -50331649, -805306369, -65536, -1, -1, -1, -1, -1, -61, -16193, -918529, -25214977, -931659779, 511705059, -805306567, -3265, -27649, -491521, -7340033, -100663297, 536870880, -481, -13825, -188417, -3932161, -58720257, -1, -65536, -1, -1, -1, -469762052, 1073741703, -3841, -61441, -1966081, -62914561, -939524104, 2147483527, -1793, -28769, -466689, -8386561, -133398529, -1058537474, 8388576, 268434963, -3073, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -1793, -261121, -7389185, -202113026, 2088763383, -1610612893, -385, -7169, -57345, -196609, -1572865, -29360129, -201326593, 536870899, -449, -14337, -458753, -6291457, -1, -65536, -1, -1, -1, -1, -1, -1, -1130369, -67106817, -1073709058, 1048571, -234881026, 536870881, -961, -15361, -245761, -3670017, -125829121, -2013265928, -241, -3841, -61441, -983041, -15728641, -234881025, -65536, -1, -1, -1, -4, 2147483591, -897, -14337, -229377, -3670017, -58720257, -1879048200, -113, -1793, -28673, -458753, -14680065, -234881025, 536870896, -241, -3841, -28673, -1, -1, -1, -65536, -1, -1, -1, -1, -101, -3809, -126465, -2023425, -63832065, -954204168, 1912602383, 536867297, -123361, -8388481, -134217217, -2147475464, 503447439, -534773762, 536870881, -481, -7681, -49153, -1, -1, -65536, -1, -1, -1, -1, -1, -4065, -524033, -33553409, -1040695300, 2143813575, -125830081, -2013274008, 2147418127, -261633, -253953, -3932161, -125829121, -2013265928, -241, -7681, -245761, -4063233, -132120577, -1, -65536, -1, -1, -1, -1, -1006632976, 2147483167, -30721, -983041, -12582913, -402653188, -49, -1537, -49153, -917441, -33553409, -520208386, 1065877475, -520094208, 1073737855, -1, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -212737, -8386561, -117538817, -941096961, -50331649, -805306375, -225, -7169, -98305, -3145729, -100663297, 1073741799, -897, -24577, -786433, -8388609, -402653186, -1, -65536, -1, -1, -1, -1, -4, 2147482624, 536807423, -2064385, -32505857, -2013265927, -193, -2049, -32769, -786433, -7864321, -32505858, -31457297, -50331905, -805310471, -33249, -522241, -262145, -1, -1, -65536, -1, -1, -1, -1, -1, -505, -1048513, -33552385, -536313858, 126353407, -260046849, 268435424, -993, -15361, -29876225, -536805377, 524284, 8388577, -469763009, -15361, -491521, -7864321, -50331649, -1, -65536, -1, -1, -1, -2, 2147483623, -385, -6145, -229377, -3145729, -50331649, -805306372, -97, -1537, -24577, -393217, -6291457, -100663297, -1610612743, -97, -1537, -12289, -1, -1, -1, -65536, -1, -1, -1, -1, -497, -262113, -8388353, -134213633, -2141126657, -29360129, 67108832, 1073741313, -8177, -65409, -63489, -229377, -1612447752, -12582969, -201327074, 1073733639, -130817, -516097, -1, -1, -65536, -1, -1, -1, -1, -241, 268432368, -114913, -1580033, -25280513, -406323202, 2030043123, 536870691, -3969, -28673, -917505, -65011713, -2063597576, -805306596, -3121, -59137, -516097, -3932161, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -2080769, -67092481, -1882980359, -8388705, -33556225, -1879063560, -123105, -523777, -2056193, -458753, -7340033, -117440513, -1879048200, -49, -897, -14337, -229377, -1572865, -65536, -1, -1, -117440513, 536870883, -385, -12289, -196609, -3145729, -100663297, -1610612743, -97, 536868992, 2147451363, -491713, -3673089, -58769409, -471597057, 205520888, 134217697, -1, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -8, -253, -8129, -113665, -3637249, -133169153, -1845493768, 1073741703, -3969, -57345, -3932161, -130023425, 67108851, 1073741415, -12673, -210945, -4128769, -65011713, -1, -1, -65536, -1, -1, -1, -1, -1, -385, -15873, -929793, -29425665, -939524100, -97, -536872464, -8673, -261633, -1884161, -786433, -12582913, -402653186, 2147483599, -769, -24577, -393217, -4194305, -1, -65536, -1, -1, -1, -1, -4, -1649, -63233, -1044481, -33488897, -534773764, 570425284, 1073741319, -8065, -126977, -2031617, -33030145, -1065353220, 1207959488, 2147482631, -16129, -253953, -1835009, -1, -1, -65536, -1, -1, -1, -1, -13, -32993, -790017, -12640257, -470679554, 1059061747, -234881217, 536867809, -57849, -1048449, -8384513, -16515073, -58720257, -939524104, -113, -3841, -126977, -917505, -1, -1, -65536, -1, -1, -1, -1, -113, -8065, -256001, -3178497, -524289, -16777217, -805306371, -97, -4065, -49921, -12289, -196609, -2097153, -100663297, -1073742605, -6529, -126977, -917505, -1, -1, -65536, -1, -1, -1, -4, 1073741697, -3697, -49537, -1841153, -25214977, -940310532, 2134900687, -201328129, 1073717235, -917953, -12589057, -201555969, 1066401779, -251658434, 536867203, -32641, -122881, -1, -1, -1, -65536, -1, -1, -1, -1, -49, -2017, -50945, -530433, -25214977, -269221892, -12582961, -134218498, 2147471303, -100097, -1630209, -29097985, -251658242, 1073741763, -1601, -50689, -548865, -8585217, -1, -1, -65536, -1, -1, -1, -1, -481, -32513, -397313, -14778369, -202899457, 1044381683, -201326786, 1073739779, -7745, -1537, -8193, -131073, -2097153, -16777217, -268435459, -225, -261633, -3932161, -1, -1, -65536, -1, -1, -1, -1, -57, -2017, -65409, -2096129, -64602113, -1025245192, 1849687951, -469763842, 1073684419, -918401, -31488001, -470745090, 1041235955, -503316740, 1073733639, -65281, -516097, -7864321, -1, -1, -65536, -1, -1, -1, -253, -4096, 536813569, -1839041, -29360129, -469762050, 1073741809, -249, -1017, -4081, -8129, -15873, -57345, 1071775687, -62916098, 134184961, -524225, -2080769, -1, -1, -1, -65536, -1, -1, -1, -1, -904, 2147450887, -524161, -4192257, -62652417, -2139095048, 67108736, 536868865, -16353, -3585, -57345, -917505, -14680065, -234881266, 536862723, -65409, -1046529, -917505, -1, -1, -65536, -1, -1, -1, -1, -1, -257, -32513, -1046529, -16760833, -202113026, 2143289319, -100663681, -6145, -57345, -458753, -3145729, -16777217, -402653188, -49, -3841, -126977, -8257537, -58720257, -1, -65536, -1, -1, -1, -939524100, 2147483535, -1793, -57345, -917505, -29360129, -482344964, 1107296192, 268433408, -32569, -508801, -7895041, -126812161, -1877999624, 33554304, 1073740815, -15361, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -9, -385, -6145, -98305, -1572865, -58720257, -805306372, -49, -769, -12289, -458753, -6291457, -100663297, -1610612743, -225, -1537, -24577, -393217, -1, -1, -65536, -1, -1, -3145729, -117440513, 268435425, -449, -15361, -1015809, -32505857, -1040187396, 1073741703, -3841, -58361, -950209, -32504833, -536854529, 524272, 8388544, 268434947, -1, -1, -1, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -523777, -67104769, -2147418120, 524224, 2088763391, -939524100, 2147483527, -1921, -61441, -983041, -31457281, -1006632964, 1073741703, -3969, -63489, -2031617, -31457281, -469762049, -65536, -1, -1, -1, -1, -1, -1, -16129, -2096641, -132245505, 133709808, -3932273, -125830916, 536856323, -245249, -4161537, -32505857, -503316488, 1073741315, -16321, -260097, -2064385, -31457281, -1, -1, -65536, -1, -1, -1, -1, -1, -1, -481, -32641, -2080769, -117440514, 536870883, -225, -513, -4097, -32769, -1075314692, 2088763328, 268435207, -1, -1, -1, -1, -1, -1, -65536, -1, -1, -1, -16, 536868864, 2147450883, -1048513, -8289281, -100909057, -3932161, -62914561, -1006632964, 2147483527, -1985, -523777, -2147479560, 655104, 67104768, 2147450895, -260097, -1, -1, -1, -1, -65536, -1, -1, -1, -57, -2048, -50113, -786433, -25165825, -402653186, -49, -797, -16381, -229617, -2097601, -3585, -24577, -196609, -1048833, -50337793, 536838147, -65281, -1, -1, -1, -65536, -1, -1, -1, -1, -3, -33, -197121, -3153921, -50724865, -811597831, -100663393, -1610615813, -61505, -1048065, -4177921, -8126465, -25165825, -402653186, 2147483591, -769, -12289, -131073, -1, -1, -65536, -1, -1, -1, -1, -33554433, -1879048221, -961, -30721, -458753, -14680065, -469762052, 1073741767, -1793, -61441, -1966081, -62914561, -939524104, 2147483407, -7681, -114689, -3670017, -1, -1, -1, -65536, -1, -1, -1, -4, -253, -8161, -233217, -7370753, -100909057, 1071906803, -31457665, -234887169, 536641521, -3145953, -50334721, -805421064, -1572977, -117441281, 536856451, -261889, -1032193, -1, -1, -1, -65536, -1, -1, -1, -1, -3841, -65281, -261633, -520193, -983041, -15728641, -2130706464, 536869895, -7937, -129025, -245761, -1966081, -15728641, -251658241, 268432353, -32737, -261121, -2031617, -1, -1, -65536, -1, -1, -1, -1, -13, -193, -3585, -49153, -1835009, -29360129, -469762050, 1073741767, -897, -30721, -458753, -15728641, -251658241, 536870883, -385, -4097, -65537, -2097153, -1, -1, -65536, -1, -1, -1, -1, 1073741811, -449, -7169, -245761, -3932161, -58720257, -939524100, 2147483527, -1793, -61441, -917505, -31457281, -469762050, 1073741795, -897, -14337, -196609, -1, -1, -1, -65536, -1, -1, -1, -1, -5, -497, -32513, -1046529, -16711681, -6291457, -100663297, 1073741763, -4065, -65025, -24577, -393217, -6291457, -201326594, 2147458959, -466433, -4161537, -1, -1, -1, -65536, -1, -1, -1, -1, -7, -225, -3585, -114689, -1835009, -29360129, -939524104, 2147483535, -3585, -57345, -1835009, -29360129, -939524100, 2147483591, -897, -14337, -229377, -1572865, -1, -1, -65536};
	int C_ARR[640] = {-18, -8, -4, 6, 16, -32, -2, 28, -12, 18, 2, 0, -4, 6, -12, 4, -38, 48, -4, 2, 46, 0, -4, -2, -24, 24, 6, -12, 0, -18, -2, 8, 16, 18, -12, 24, 10, -20, 16, -18, 54, -8, 0, -6, -20, 24, -6, -8, -4, -10, 46, -12, 4, -2, -16, 24, -10, -8, 0, -2, -24, 6, -10, 8, 14, 22, -8, -10, -6, 20, 56, -10, -2, -4, -18, 22, -4, -10, -2, -8, -6, -12, -16, -6, 40, 0, 10, -4, -8, 2, -10, 24, 0, 2, 8, -16, -6, 20, -16, -14, 44, -14, 10, 0, -22, 14, 0, -14, -10, -8, 26, -8, 16, -14, -4, 4, 30, -36, 16, -10, 4, 2, -18, 8, -2, -6, -32, 38, -2, 12, -30, -8, -8, 14, 12, -4, 2, -4, 0, 30, -22, -12, -8, -6, 40, -24, 6, 0, -4, 18, -32, 42, 2, -4, -2, -10, -4, 10, 14, 0, -26, -8, -4, 10, 24, -12, -10, 8, 8, 22, -14, -4, -20, -2, 20, -8, -18, 24, 0, 34, 6, 4, -8, 42, -24, 12, -14, 4, 0, 2, -4, 6, -14, 0, -2, -6, -28, 38, -2, 16, -34, 28, -12, 6, 8, 0, -6, 0, 20, 14, 2, -4, 12, -14, 8, -4, 46, -12, -4, -6, -12, 14, 2, 24, -2, 18, -12, -6, 2, 4, -12, 6, -6, 8, -2, -10, -32, 50, -6, 8, -24, 38, -6, 4, 6, -14, 16, -2, 10, -8, 0, -22, 10, 0, 26, -6, 16, -14, -10, 8, -2, -16, -16, 14, 0, 0, -34, 16, 20, 22, 12, -2, 26, -4, 6, -2, 40, -34, -2, -20, 2, -4, -8, 6, 4, -12, -26, 36, 0, 22, 6, 0, 0, 10, -12, 40, -10, -8, 16, 6, -6, -12, 20, 14, -16, 0, -26, 24, 12, 10, -24, 42, 6, 4, 2, -18, 12, -2, 10, 4, -4, -10, 2, 36, -18, 2, -28, 2, 14, 8, -4, 6, 6, 0, 2, 6, 4, -22, 50, 0, -20, -6, -14, 8, 14, -2, -12, 6, 6, 40, -10, -4, 28, 14, 8, -8, 34, -28, 0, -2, -16, 18, 2, 12, -6, -6, -20, 2, 18, 20, -24, -18, -10, 4, 26, -14, 4, 2, -6, 32, 8, 6, -2, 8, -2, 2, 0, -14, 34, -4, -22, -12, -16, -2, 36, -20, -2, 8, -12, 14, -2, 8, -12, 30, -12, 8, -14, 16, -4, 14, 44, -14, 6, -8, -10, 14, 8, -14, -10, -4, 12, -18, -6, -12, 14, 14, -4, 2, 10, 24, -12, 2, -18, 16, 10, -6, -12, 6, 14, 28, 48, -18, -10, -4, -6, 18, -8, -2, -6, 4, 12, -6, 10, 20, -10, 30, 4, -30, 22, -4, 12, -6, -10, 32, -18, 26, -12, -10, 14, 12, -2, 4, 0, 22, -20, 16, -30, 12, 0, 14, -8, 10, 14, 0, 10, -14, 44, -18, 10, -8, -24, 38, -6, 8, 6, 2, -12, 6, -6, 0, -4, -6, 14, -12, 10, -10, 52, -22, 2, -4, 6, 0, -12, 14, -4, 0, -34, 36, 0, 10, 20, -10, -2, -16, -6, 30, -4, -10, 26, 12, 16, 2, -2, 4, -14, 50, -16, -10, 14, -4, 10, -8, 36, 22, -24, 4, -10, -4, 4, -10, 0, -10, 6, 12, 2, 30, 0, -30, 18, -12, -18, -12, -12, -14, 40, 0, 14, -8, -4, 14, -18, 44, 12, -2, -4, -8, 2, 4, 16, -10, 42, -16, 0, 2, -16, 16, -14, 4, -4, 6, -6, 4, 8, 42, -12, -12, -22, 4, 4, 2, -38, 20, -4, -2, 20, -8, -2, 8, 0, 10, -26, 40, 0, 6, 0, -16, 2, -4, 12, 6, -6, 12, 0, 30, -16, -8, -18, 8, 4, 14, -18, 32, 4, -2, 0, -12, -2, 0, 16, 14};

	for (int i=0; i<1600; i++){
		IN[i] = push_stream<D_TYPE>(IN_ARR[i], i==1599);
	}

	numpy_network(IN, OUT);

	int err = 0;
	for (int i=0; i<640; i++){
		printf("%d vs %d\n", pop_stream<D_TYPE>(OUT[i]), C_ARR[i]);
		err += !(pop_stream<D_TYPE>(OUT[i]) == C_ARR[i]);
	}

	return err;
}
